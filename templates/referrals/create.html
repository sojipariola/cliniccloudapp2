{% extends 'base/base.html' %}
{% block title %}{% if patient %}New Referral for {{ patient }}{% else %}New Referral{% endif %}{% endblock %}
{% block content %}

{% if patient %}
  {% include 'includes/patient_header.html' with patient=patient %}
{% endif %}

<div class="form-container" style="max-width:600px;">
  <h2>{% if patient %}New Referral for {{ patient }}{% else %}New Referral{% endif %}</h2>
  <form method="post">
    {% csrf_token %}
    {% if patient %}
      <input type="hidden" name="patient" value="{{ patient.id }}">
    {% else %}
      <label for="patient">Patient</label>
      <select name="patient" id="patient" required>
        <option value="">Select patient</option>
        {% for p in patients %}
          <option value="{{ p.id }}">{{ p }}</option>
        {% endfor %}
      </select>
    {% endif %}
    <label for="from_clinic">From Clinic</label>
    <select name="from_clinic" id="from_clinic" required>
      <option value="">Select clinic</option>
        {% for c in clinics %}
          <option value="{{ c.id }}">{{ c.name }} ({{ c.get_clinic_type_display }})</option>
        {% endfor %}
    </select>
    <label for="to_clinic">To Clinic</label>
    <select name="to_clinic" id="to_clinic" required>
      <option value="">Select clinic</option>
        {% for c in clinics %}
          <option value="{{ c.id }}">{{ c.name }} ({{ c.get_clinic_type_display }})</option>
        {% endfor %}
    </select>
    <label for="notes">Notes</label>
    <textarea name="notes" id="notes" rows="3"></textarea>
    <button type="submit">Create Referral</button>
  </form>
</div>
{% endblock %}
