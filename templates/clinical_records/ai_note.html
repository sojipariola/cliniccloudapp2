{% extends 'base/base.html' %}
{% block title %}AI Note-Taking{% endblock %}
{% block content %}
<div class="form-container" style="max-width:700px;">
  <div style="background:#e0f2fe; padding:1.5rem; border-radius:8px; margin-bottom:2rem;">
    <h2 style="margin:0 0 0.5rem 0;">üè• AI Note-Taking for Clinical Records</h2>
    <p style="margin:0; color:#0369a1;"><strong>Clinic Specialization:</strong> {{ tenant_specialization|default:"General Practice" }}</p>
  </div>
  
  <form method="post" style="background:#f9fafb; padding:1.5rem; border-radius:8px; border:1px solid #e5e7eb;">
    {% csrf_token %}
    
    <div style="margin-bottom:1.5rem;">
      <label for="specialization" style="display:block; margin-bottom:0.5rem; font-weight:600;">Specialization</label>
      <select name="specialization" id="specialization" style="width:100%; padding:0.75rem; border:1px solid #d1d5db; border-radius:6px;">
        {% for value, label in specialization_choices %}
          <option value="{{ value }}" {% if value == specialization %}selected{% endif %}>{{ label }}</option>
        {% endfor %}
      </select>
      <small style="color:#6b7280; display:block; margin-top:0.25rem;">Select the specialization for this note (defaults to your clinic's specialization)</small>
    </div>
    
    <div style="margin-bottom:1.5rem;">
      <label for="transcript" style="display:block; margin-bottom:0.5rem; font-weight:600;">Transcript or Dictation</label>
      <textarea name="transcript" id="transcript" rows="8" required style="width:100%; padding:0.75rem; border:1px solid #d1d5db; border-radius:6px; font-family:monospace;" placeholder="Paste your transcript or dictation here...">{{ transcript|default:'' }}</textarea>
      <small style="color:#6b7280; display:block; margin-top:0.25rem;">Describe the patient encounter, symptoms, examination findings, etc.</small>
    </div>
    
    <button type="submit" style="background:#0f4c81; color:#fff; padding:0.75rem 1.5rem; border:none; border-radius:6px; font-weight:600; cursor:pointer;">Generate Note</button>
  </form>
  
  {% if ai_note %}
    <div style="margin-top:2rem;">
      <div style="background:#ecfdf5; padding:1rem; border-left:4px solid #10b981; border-radius:6px; margin-bottom:1.5rem;">
        <p style="margin:0; color:#065f46;"><strong>‚úì Note Generated for:</strong> <span style="font-weight:normal;">{{ ai_note.context }}</span></p>
      </div>
      
      <h3 style="margin-top:0;">Generated Note Sections</h3>
      <div style="background:#fff; border:1px solid #e5e7eb; border-radius:8px; overflow:hidden;">
        {% for section, content in ai_note.sections.items %}
          <div style="padding:1rem; border-bottom:1px solid #e5e7eb;">
            <strong style="color:#0f4c81;">{{ section }}</strong>
            <p style="margin:0.5rem 0 0 0; white-space:pre-wrap; color:#374151;">{{ content }}</p>
          </div>
        {% empty %}
          <div style="padding:1rem;">No sections generated</div>
        {% endfor %}
      </div>
    </div>
  {% endif %}
</div>
{% endblock %}
